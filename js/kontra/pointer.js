!function(i,n){var e,r,o,a,u=[],c=[],f={},s=[],h={},d={0:"left",1:"middle",2:"right"};function l(){for(var n,t,e,r=c.length?c:u,o=r.length-1;0<=o;o--){var i,a=r[o];if(a.collidesWithPointer?i=a.collidesWithPointer(y):(n=a,void 0,t=y.x-Math.max(n.x,Math.min(y.x,n.x+n.width)),e=y.y-Math.max(n.y,Math.min(y.y,n.y+n.height)),i=t*t+e*e<y.radius*y.radius),i)return a}}function t(n){var t=d[n.button];h[t]=!0,p(n,"onDown")}function v(n){var t=d[n.button];h[t]=!1,p(n,"onUp")}function p(n,t){var e,r,o;i.canvas&&(-1!==n.type.indexOf("mouse")?(e=n.clientX,r=n.clientY):(e=(n.touches[0]||n.changedTouches[0]).clientX,r=(n.touches[0]||n.changedTouches[0]).clientY),y.x=e-i.canvas.offsetLeft,y.y=r-i.canvas.offsetTop,n.target===i.canvas&&(o=l())&&o[t]&&o[t](),f[t]&&f[t](n,o))}n("mousedown",t),n("touchstart",t),n("mouseup",v),n("touchend",v),n("blur",function(n){h={}}),n("mousemove",(e=function(n){p(n,"onOver")},r=32,function(){var n=this,t=arguments;a?(clearTimeout(o),o=setTimeout(function(){Date.now()-a>=r&&(e.apply(n,t),a=Date.now())},r-(Date.now()-a))):(e.apply(n,t),a=Date.now())}));var y=i.pointer={x:0,y:0,radius:5,track:function(n){n=Array.isArray(n)?n:[n];for(var t,e=0;t=n[e];e++)t._render||(t._render=t.render,t.render=function(){u.push(this),this._render&&this._render()}),-1===s.indexOf(t)&&s.push(t)},untrack:function(n){n=Array.isArray(n)?n:[n];for(var t,e=0;t=n[e];e++){t.render=t._render,t._render=null;var r=s.indexOf(t);if(-1!==r){for(var o=r;o<=s.length-2;o++)s[o]=s[o+1];s.length--}}},over:function(n){return-1!==s.indexOf(n)&&l()===n},onDown:function(n){f.onDown=n},onUp:function(n){f.onUp=n},pressed:function(n){return!!h[n]}};i._tick=function(){c.length=0,u.forEach(function(n){c.push(n)}),u.length=0}}(kontra,window.addEventListener);